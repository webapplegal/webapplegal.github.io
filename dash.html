<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="dash.css">
    <script type="module" src="./JS/dbconfig.js"></script>
    <script type="module" src="LoadItems.js"></script>

    <style>
        
    </style>
</head>
<body>

    <div id="page-container" style="margin: 0px;">

        <div style="display: flex; flex-direction: row; justify-content: right; align-items: center; height: 40px; margin-right:0px; background-color: rgb(36, 36, 36); padding-top: 10px;">
            <h1 style="font-family: Arial, Helvetica, sans-serif; margin: 0; margin-right: 10px; color: white;">CALESA - P.O.S </h1>
            <div style="width: 40px; margin-right: 10px;" id="user-menu">
                <button id="ham" onclick="this.focus(); document.getElementById('ham').innerHTML=`<button class='sub-but'>Change Password</button><br><button class='sub-but'>Account Settings</button><br><button class='sub-but'>Users</button><br>`" onblur="document.getElementById('ham').innerHTML=`<img src='https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ-NvfI8Zn1ZixUrDKtyy_LvvHpQ7ru0V-eHw&usqp=CAU' style='mix-blend-mode: lighten; width: 15px; margin-top: 3px;'>`">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ-NvfI8Zn1ZixUrDKtyy_LvvHpQ7ru0V-eHw&usqp=CAU" style="mix-blend-mode: lighten; width: 15px; margin-top: 3px;">
                </button>
            </div>
        </div>

        <div id="user-details" style="text-align: right; display: flex; justify-content: right; margin-right: 0px; margin-bottom: 0px; background-color: rgb(36, 36, 36); padding-bottom: 10px;">
            <h1 style="font-family: Arial, Helvetica, sans-serif; font-size: 16px; margin: 0; margin-right: 10px; color: white;">Bienvenido</h1><span id="user" style="font-size: 16px; font-family: Arial, Helvetica, sans-serif; margin-right: 20px; color: white;"></span>
            <script>
                document.getElementById('user').textContent = localStorage.getItem('USER')
            </script>
        </div>

        

        <div style="display: flex; justify-content: center; align-items: flex-start; text-align: center; flex-wrap: wrap-reverse;" id="body-content">
            
            <div class="row"> 
                <div class="column" style="width: 360px;">

                    <div id="sidebar-1" style="margin-left: 250px;" onmouseenter="dispSidebar(3,-132); dispSidebar(2,-142); dispSidebar(1,-150)" onmouseleave="resetSidebars()">
                        <button class="men-title">OTHER</button><br>
                        <button class="men-but" id="Pastel Choc" onclick="javascript:this.focus()" onfocus="showSub(this.id,1)" onblur="hideSub(this.id)">Pastel Choc</button>
                        <button class="men-but" id="Pay Limon" onclick="javascript:this.focus()" onfocus="showSub(this.id,1)" onblur="hideSub(this.id)">Pay Limon</button>
                        <button class="men-but" id="Pay Chisp" onclick="javascript:this.focus()" onfocus="showSub(this.id,1)" onblur="hideSub(this.id)">Pay Chisp</button>
                        <button class="men-but" id="Pay Fram" onclick="javascript:this.focus()" onfocus="showSub(this.id,1)" onblur="hideSub(this.id)">Pay Fram</button>
                        <button class="men-but" id="Choco flan" onclick="javascript:this.focus()" onfocus="showSub(this.id,1)" onblur="hideSub(this.id)">Choco flan</button>
                        <button class="men-but" id="Muffin" onclick="javascript:this.focus()" onfocus="showSub(this.id,1)" onblur="hideSub(this.id)">Muffin</button>
                        <button class="men-but" id="Brownie" onclick="javascript:this.focus()" onfocus="showSub(this.id,1)" onblur="hideSub(this.id)">Brownie</button>
                        <button class="men-but" id="Galleta" onclick="javascript:this.focus()" onfocus="showSub(this.id,1)" onblur="hideSub(this.id)">Galleta</button>
                        <button class="men-but" id="Agua 1L" onclick="javascript:this.focus()" onfocus="showSub(this.id,1)" onblur="hideSub(this.id)">Agua 1L</button>
                        <button class="men-but" id="Agua 500ml" onclick="javascript:this.focus()" onfocus="showSub(this.id,1)" onblur="hideSub(this.id)">Agua 500ml</button>
                        <button class="men-but" id="Coca cola" onclick="javascript:this.focus()" onfocus="showSub(this.id,1)" onblur="hideSub(this.id)">Coca cola</button>
                        <button class="men-but" id="Refre Sabor" onclick="javascript:this.focus()" onfocus="showSub(this.id,1)" onblur="hideSub(this.id)">Refre Sabor</button>
                    
                    </div>

                    <div id="sidebar-2" style="margin-left: 125px;" onmouseenter="dispSidebar(1,80); dispSidebar(2,-80); dispSidebar(3,-72)" onmouseleave="resetSidebars()">
                        <button class="men-title">COLD</button><br>
                        <button class="men-but" id="Frap Natur" onclick="javascript:this.focus()" onfocus="showSub(this.id,2)" onblur="hideSub(this.id)">Frap Natur</button>
                        <button class="men-but" id="Frap Moka" onclick="javascript:this.focus()" onfocus="showSub(this.id,2)" onblur="hideSub(this.id)">Frap Moka</button>
                        <button class="men-but" id="Frap Cajeta" onclick="javascript:this.focus()" onfocus="showSub(this.id,2)" onblur="hideSub(this.id)">Frap Cajeta</button>
                        <button class="men-but" id="Frap Oreo" onclick="javascript:this.focus()" onfocus="showSub(this.id,2)" onblur="hideSub(this.id)">Frap Oreo</button>
                        <button class="men-but" id="Frap Nutella" onclick="javascript:this.focus()" onfocus="showSub(this.id,2)" onblur="hideSub(this.id)">Frap Nutella</button>
                        <button class="men-but" id="Frap Ferrero" onclick="javascript:this.focus()" onfocus="showSub(this.id,2)" onblur="hideSub(this.id)">Frap Ferrero</button>
                        <button class="men-but" id="Frap Chai" onclick="javascript:this.focus()" onfocus="showSub(this.id,2)" onblur="hideSub(this.id)">Frap Chai</button>
                        <button class="men-but" id="Frap Matcha" onclick="javascript:this.focus()" onfocus="showSub(this.id,2)" onblur="hideSub(this.id)">Frap Matcha</button>
                        <button class="men-but" id="Frap Perlas" onclick="javascript:this.focus()" onfocus="showSub(this.id,2)" onblur="hideSub(this.id)">Frap Perlas</button>
                        <button class="men-but" id="Frap Sabor" onclick="javascript:this.focus()" onfocus="showSub(this.id,2)" onblur="hideSub(this.id)">Frap Sabor</button>
                    </div>

                    
    
                    
                    <div id="sidebar-3" style="margin-left: 0px;" onmouseenter="dispSidebar(1,132); dispSidebar(3,-20); dispSidebar(2,142)" onmouseleave="resetSidebars()">

                        <button class="men-title">HOT</button><br>
                        <button class="men-but" id="Amer" onclick="javascript:this.focus()" onfocus="showSub(this.id,3)" onblur="hideSub(this.id)">Amer</button>
                        <button class="men-but" id="Amer - Leche" onclick="javascript:this.focus()" onfocus="showSub(this.id,3)" onblur="hideSub(this.id)">Amer Leche</button>
                        <button class="men-but" id="Amer - Sabor" onclick="javascript:this.focus()" onfocus="showSub(this.id,3)" onblur="hideSub(this.id)">Amer Sabor</button>
                        <button class="men-but" id="Latte" onclick="javascript:this.focus()" onfocus="showSub(this.id,3)" onblur="hideSub(this.id)">Latte</button>
                        <button class="men-but" id="Latte - Sabor" onclick="javascript:this.focus()" onfocus="showSub(this.id,3)" onblur="hideSub(this.id)">Latte Sabor</button>
                        <button class="men-but" id="Cap" onclick="javascript:this.focus()" onfocus="showSub(this.id,3)" onblur="hideSub(this.id)">Cap</button>
                        <button class="men-but" id="Cap - Sabor" onclick="javascript:this.focus()" onfocus="showSub(this.id,3)" onblur="hideSub(this.id)">Cap Sabor</button>
                        <button class="men-but" id="Chai" onclick="javascript:this.focus()" onfocus="showSub(this.id,3)" onblur="hideSub(this.id)">Chai</button>
                        <button class="men-but" id="Matcha" onclick="javascript:this.focus()" onfocus="showSub(this.id,3)" onblur="hideSub(this.id)">Matcha</button>
                        <button class="men-but" id="Te" onclick="javascript:this.focus()" onfocus="showSub(this.id,3)" onblur="hideSub(this.id)">Te</button>
                        
                        </div>
    
                </div>  

                <div id="bottombar">
                    <h3>Herramientas</h3>
                    <button class="men-but" id="Ejemplo">Ejemplo</button>

                </div>

            </div>

            <div id="subtotal-pane" class="column-full" style="margin-left: 10px; width: 360px; text-align: center; border: 1px solid gray; border-radius: 15px;">
                <div style="text-align: left; padding-left: 30px; width: 300px;">
                        <h1 style="font-family: Arial, Helvetica, sans-serif; margin-top: 20px; text-align: right;">Subtotal</h1>
                        <span style="font-weight: bold; font-family: Arial, Helvetica, sans-serif;">Orden: </span><span id="orderNo">109292831</span> <br>
                        <span style="font-weight: bold; font-family: Arial, Helvetica, sans-serif;">Fecha: </span><span id="date">13/11/2023</span> <br>
                        <span style="font-weight: bold; font-family: Arial, Helvetica, sans-serif;">Fecha: </span><span id="date">13/11/2023</span> <br>
                        <br>
                        <span style="font-weight: bold; font-size: 16px; font-family: Arial, Helvetica, sans-serif;"> Articulos:</span>
                        <ul style="list-style: none; text-align: left; height: 260px; overflow-y: scroll;" id="orderList">
                        </ul>

                        <button class="primary-button" onmousedown="" onfocus="">CASH</button>
                        <button class="secondary-button">CARD</button>

                </div>      
            </div>                
        </div>
    </div>
    

</body>
<script>
    function dispSidebar(id,xdisp){
        document.getElementById('sidebar-'+String(id)).style.transform = 'translateX('+xdisp+'px)';
    }

    function resetSidebars(){
        dispSidebar(1,0);
        dispSidebar(2,0);
        dispSidebar(3,0);
    }

    function showSub(ID,options){
        const menuitems = document.getElementById(ID);

        if( menuitems.matches(':focus')){
        if(options==1){
            setTimeout(() => {  

            menuitems.innerHTML = `<br>
            <button onmousedown="addToOrder('${ID}','Ch')" class="size-button">Add</button> 
            `

            }, 100);
        }
        if(options==2){
            setTimeout(() => {  

            menuitems.innerHTML = `<br>
            <button onmousedown="addToOrder('${ID}','Ch')" class="size-button">Ch</button> 
            <button onmousedown="addToOrder('${ID}','G')" class="size-button">G</button>
            `

            }, 100);}
        if(options==3){
            setTimeout(() => {  

            menuitems.innerHTML = `<br>
            <button onmousedown="addToOrder('${ID}','Ch')" class="size-button">Ch</button> 
            <button onmousedown="addToOrder('${ID}','M')" class="size-button">M</button> 
            <button onmousedown="addToOrder('${ID}','G')" class="size-button">G</button>
            `

            }, 100);}
        }

    }
    
    function hideSub(ID){
    
        const menuitems = document.getElementById(ID);
        menuitems.innerHTML = ID;
        menuitems.blur()
        //console.log("hiding",ID)
        
    }

    function addToOrder(ID,size){
        const menuitems = document.getElementById(ID);
        menuitems.blur()
        hideSub(ID)

        let List = document.getElementById('orderList')
        let items = {}
    
        List.innerHTML += `<li style="display: flex; flex-direction: row;"><div style="width: 130px;">${ID}</div><div style="width: 50px;">${size}</div><div style="width: 50px;">${itemCosts[ID][size].toLocaleString('en-US', {style: 'currency', currency: 'USD',})}</div></li>`
        
        if(items[ID]==null){
            items.ID = itemCosts[ID][size]
        } 
        else {
            items[ID] += itemCosts[ID][size]
        }

        console.log(items)

    }

</script>

<script type="module">
    import {getDatabase, set, get, update, remove, ref, child, onValue} from "https://www.gstatic.com/firebasejs/10.3.1/firebase-database.js"; 
    window.ItemDir = ref(db,'Items/');
    window.itemCosts = {}

    onValue(ItemDir, (snapshot)=>{
        snapshot.forEach(
        function(ChildSnapshot){
            itemCosts[ChildSnapshot.key] = ChildSnapshot.val()
        })
    });
</script>
</html>

